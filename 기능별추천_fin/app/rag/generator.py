## LLM ë‹µë³€ ìƒì„± í”„ë¡¬í”„íŠ¸
## ì´í›„ ìˆ˜ì • í•„ìš”ìš”

# ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª¨ìŒ
from typing import List
from openai import OpenAI
from langchain_openai import ChatOpenAI
from langchain.schema import Document


# í”„ë¡¬í”„íŠ¸ ìž‘ì„±
_llm = ChatOpenAI(model_name="gpt-4o", temperature=0.5)

PROMPT = """ë‹¹ì‹ ì€ ê´€ì ˆ, ë¼ˆ, ê·¼ìœ¡, ë‡Œ, ì†Œí™”ê³„ ë“±ì˜ ì¦ìƒì— ë”°ë¼ ì ì ˆí•œ ê±´ê°•ê¸°ëŠ¥ì‹í’ˆì„ ì¶”ì²œí•˜ëŠ” ì˜ì–‘ì œ ì „ë¬¸ê°€ìž…ë‹ˆë‹¤.
ì•„ëž˜ **ì»¨í…ìŠ¤íŠ¸**ëŠ” ë‘ ë¶€ë¶„ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.

â‘  *ì œí’ˆÂ·ì„±ë¶„ ì»¨í…ìŠ¤íŠ¸*  
â‘¡ *MSD ë§¤ë‰´ì–¼ì—ì„œ ì¶”ì¶œí•œ ë¶€ìž‘ìš©Â·ì£¼ì˜ì‚¬í•­ ì»¨í…ìŠ¤íŠ¸* 

ë‘ ì»¨í…ìŠ¤íŠ¸ì™€ ì‚¬ìš©ìžì˜ ì§ˆë¬¸ì„ ëª¨ë‘ ë°˜ì˜í•´, ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ë§ˆí¬ë‹¤ìš´ ë¦¬í¬íŠ¸ë¥¼ ìž‘ì„±í•˜ì„¸ìš”.

ì»¨í…ìŠ¤íŠ¸:
{context}                     # â‘  + â‘¡ ê°€ \n ìœ¼ë¡œ ì´ì–´ì„œ ë“¤ì–´ì˜´

ì§ˆë¬¸:
{question}

ðŸ“Œ ë¬¸ì œ ì„¤ëª…
{question}ì™€(ê³¼) ê´€ë ¨ëœ ì‹ ì²´ ê¸°ì „Â·ì›ì¸ì„ 2~3ë¬¸ìž¥ìœ¼ë¡œ ìš”ì•½í•©ë‹ˆë‹¤.

## ì¶”ì²œ ê¸°ëŠ¥ì„± ì„±ë¶„
| ì„±ë¶„ëª… | ê¸°ëŠ¥ì„± ì„¤ëª… |
|--------|------------|
| ì˜ˆ) í™ì‚¼ | ë©´ì—­ ì¦ì§„Â·í”¼ë¡œ ê°œì„  ë„ì›€ |
| ì˜ˆ) ë§¤ì‹¤ì¶”ì¶œë¬¼ | ì†Œí™” íš¨ì†Œ í™œì„±í™” |

## ë¶€ìž‘ìš©Â·ì•½ë¬¼ ìƒí˜¸ìž‘ìš©  â˜… MSD ê¸°ë°˜
ì•„ëž˜ ë‚´ìš©ì„ â€˜ì‚¬ì‹¤ ê·¸ëŒ€ë¡œâ€™ ê°„ê²°ížˆ ìš”ì•½í•˜ì„¸ìš”.  
(ê·¼ê±° ì¶œì²˜: MSD ë§¤ë‰´ì–¼)

- **ì£¼ìš” ë¶€ìž‘ìš©:** â€¢â€¢â€¢  
- **ì•½ë¬¼ ìƒí˜¸ìž‘ìš©:** â€¢â€¢â€¢  
- **ê³ ìœ„í—˜êµ°(ìž„ì‚°ë¶€Â·í•­ì‘ê³ ì œ ë³µìš©ìž ë“±):** â€¢â€¢â€¢  

## ì¶”ì²œ ì˜ì–‘ì œ ë¦¬ìŠ¤íŠ¸
### 1. {{ì œí’ˆëª…}}
- âœ… **ì£¼ì„±ë¶„**: â€¦  
- ðŸ’Š **ê¶Œìž¥ ë³µìš©ë²•**: â€¦  
- âš ï¸ **ì£¼ì˜ì‚¬í•­**: MSD ë¶€ìž‘ìš© ìš”ì•½ì—ì„œ í•´ë‹¹ ì„±ë¶„ ë¶€ë¶„ ì°¸ì¡°

â€¦ (2â€“3ê°œ ì œí’ˆ)

## ðŸ“Œ ë³µì•½ íŒ
- íš¨ê³¼ ë°œí˜„ ì˜ˆìƒ ê¸°ê°„ â€¦  
- ì‹ì „/ì‹í›„, ìˆ˜ë¶„ ì„­ì·¨ ë“± â€¦  

ðŸ“š **ì°¸ê³ ë¬¸í—Œ**  
- êµ­ë‚´ ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ ì •ë³´ í¬í„¸  
- MSD ë§¤ë‰´ì–¼ ë¶€ìž‘ìš©Â·ìƒí˜¸ìž‘ìš©
"""


def generate_answer(context_docs: List[Document], question: str) -> str:
    context = "\n".join([d.page_content for d in context_docs])
    prompt = PROMPT.format(context=context, question=question)
    return _llm.invoke(prompt).content.strip()

